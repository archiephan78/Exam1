---
####
  - name: install ejabberd
    sudo: yes
    apt:
      name: "{{ ejb_pkg }}"
      update_cache: yes
      state: present
###
  - name: config file
    template:
      src: ejabberd.yml.j2
      dest: /etc/ejabberd/ejabberd.yml
      mode: 0644
    notify: restart ejabberd service
#  - name: restart service
#    shell: service ejabberd restart
###
#  - name: create user 
#    action: ejabberd_user username={{ user_admin }} host={{ host_name }} password= {{ user_pass }}
  - name: create a user if it does not exists
    ejabberd_user:
      username: "{{ user_admin }}"
      host: localhost
      password: "{{ user_pass }}"

#  - name: restart service
#    shell: service ejabberd restart
